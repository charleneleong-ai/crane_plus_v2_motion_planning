## Benchmarking 

### Planning Time

Adapted from [moveit_benchmark_statistics.py](https://github.com/ros-planning/moveit/blob/melodic-devel/moveit_ros/benchmarks/scripts/moveit_benchmark_statistics.py) from MoveIt! framework. See [here](http://docs.ros.org/kinetic/api/moveit_tutorials/html/doc/benchmarking/benchmarking_tutorial.html) for more details on parameter input.

1. Launch CRANE+V2 simulation. Adjust and save the desired scenes, queries and states to be benchmarked in the MongoDB Warehouse.

    ```bash 
    $ roslaunch crane_plus_moveit_config demo.launch db:=true
    ```

2. Within the *Motion Planning* RViz plugin, connect to the database by pressing the *Connect* button in the *Context* tab.

3. Save a scene on the *Stored Scenes* tab and name it `Scene1` by double clicking the scene in the list.

4. Move the start and goal states of the Crane arm by using the interactive markers.

5. Save an associated query for the `Scene1` scene and name the query `Move1`. Save a start state for the robot on the *Stored States* tab and name it `Start1`. 

6. The config file `/scripts/benchmark_config.yaml` refers to the scenes, queries and start states used for benchmarking. Modify them appropriately.

7. Set the username for the `output_directory` to export the benchmarked files. Log files will be saved to `/home/${USER}/catkin_ws/src/crane_plus_v2_motion_planning/crane_plus_control/benchmarks/` by default. 

    ```bash
    $ rosed crane_plus_control benchmark_config.yaml
    ```

8. Bring down your previous `demo.launch` file ( <kbd>Ctrl</kbd> + <kbd>C</kbd>) and run the benchmarks. 

    ```bash
    $ roslaunch crane_plus_control benchmark.launch 
    ```

9. Run `moveit_benchmark_statistics.py`  to view results. The

    ```bash
    $ rosrun crane_plus_control moveit_benchmark_statistics.py 
    ```

10. To generate a PDF of plots in the `benchmarks/plots` folder.

     ```bash
     $ python moveit_benchmark_statistics.py -p 
     ```

11. To change database name:

       ```bash
       $ python moveit_benchmark_statistics.py -d [dbname]
       ```

12. Click on the <kbd>Change Database</kbd> button to upload the `benchmark.db` file generated by script to [plannerarena.org](http://plannerarena.org/) to interactively visualise results. 

![](../imgs/plannerarena.png)



